// middleware.js
import { withAuth } from "@kinde-oss/kinde-auth-nextjs/middleware";
import { NextResponse } from "next/server";

export default withAuth(
    function middleware(request) {
        const response = NextResponse.next();

        // Ø¥Ø¹Ø¯Ø§Ø¯ cookies Ù„Ù„Ø¹Ù…Ù„ Ø¹Ø¨Ø± Ù†Ø·Ø§Ù‚Ø§Øª vercel
        response.cookies.set({
            name: 'kinde_auth',
            value: request.cookies.get('kinde_auth')?.value || '',
            secure: true,
            sameSite: 'none',
            domain: '.vercel.app', // ğŸ”¥ Ù…Ù‡Ù… Ù„Ù„Ù†Ø·Ø§Ù‚Ø§Øª Ø§Ù„ÙØ±Ø¹ÙŠØ©
            path: '/',
            httpOnly: true
        });

        return response;
    }
);

export const config = {
    matcher: ['/api/auth/:path*']
};